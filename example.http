GET https://qrlew-zsyaspsckq-od.a.run.app/ HTTP/1.2

### Check the public key
GET https://qrlew-zsyaspsckq-od.a.run.app/public_key HTTP/1.2

### Get a dot representation of the Relation
POST https://qrlew-zsyaspsckq-od.a.run.app/dot HTTP/1.2
content-type: application/json

{
  "dataset": {
    "tables": [
      {
        "name": "table_1",
        "path": [
          "schema",
          "table_1"
        ],
        "schema": {
          "fields": [
            {
              "name": "a",
              "data_type": "Float"
            },
            {
              "name": "b",
              "data_type": "Integer"
            }
          ]
        },
        "size": 10000
      }
    ]
  },
  "query": "SELECT * FROM table_1",
  "dark_mode": true
}

### Get the dp version of the relation
POST https://qrlew-zsyaspsckq-od.a.run.app/dp_compile HTTP/1.2
content-type: application/json

{
  "dataset": {
    "tables": [
      {
        "name": "user_table",
        "path": [
          "schema",
          "user_table"
        ],
        "schema": {
          "fields": [
            {
              "name": "id",
              "data_type": "Integer"
            },
            {
              "name": "name",
              "data_type": "Text"
            },
            {
              "name": "age",
              "data_type": "Integer"
            },
            {
              "name": "weight",
              "data_type": "Float"
            }
          ]
        },
        "size": 10000
      },
      {
        "name": "action_table",
        "path": [
          "schema",
          "action_table"
        ],
        "schema": {
          "fields": [
            {
              "name": "action",
              "data_type": "Text"
            },
            {
              "name": "user_id",
              "data_type": "Integer"
            },
            {
              "name": "duration",
              "data_type": "Float"
            }
          ]
        },
        "size": 10000
      }
    ]
  },
  "query": "SELECT sum(duration) FROM action_table WHERE duration > 0 AND duration < 24",
  "protected_entity": [
    [
      "user_table",
      [],
      "id"
    ],
    [
      "action_table",
      [
        [
          "user_id",
          "user_table",
          "id"
        ]
      ],
      "id"
    ]
  ],
  "epsilon": 1.0,
  "delta": 0.00001,
  "epsilon_tau_thresholding": 1.0,
  "delta_tau_thresholding": 0.00001
}

### Verify the dp version of the relation
POST https://qrlew-zsyaspsckq-od.a.run.app/verify HTTP/1.2
content-type: application/json

{
  "value": "WITH join_sgtn (field_lehu, field_g31_, field_5z2s, field_xsv3, field_vhu6, field_cgi2, field_i0go) AS (SELECT * FROM schema.user_table AS user_table JOIN schema.action_table AS action_table ON (action_table.user_id) = (user_table.id)), _PROTECTED_action_table (_PROTECTED_ENTITY_ID_, _PROTECTED_ENTITY_WEIGHT_, action, user_id, duration) AS (SELECT md5(CAST(field_lehu AS VARCHAR)) AS _PROTECTED_ENTITY_ID_, 1 AS _PROTECTED_ENTITY_WEIGHT_, field_vhu6 AS action, field_cgi2 AS user_id, field_i0go AS duration FROM join_sgtn), map_kzp0 (_PROTECTED_ENTITY_ID_, _PROTECTED_ENTITY_WEIGHT_, field_8mze) AS (SELECT _PROTECTED_ENTITY_ID_ AS _PROTECTED_ENTITY_ID_, _PROTECTED_ENTITY_WEIGHT_ AS _PROTECTED_ENTITY_WEIGHT_, duration AS field_8mze FROM _PROTECTED_action_table WHERE ((duration) > (0)) AND ((duration) < (24))), map_25wv (field_b_lu, field_6zur) AS (SELECT field_8mze AS field_b_lu, _PROTECTED_ENTITY_ID_ AS field_6zur FROM map_kzp0), map_ioza (field__lvx, field_ifx6) AS (SELECT field_b_lu AS field__lvx, field_6zur AS field_ifx6 FROM map_25wv), reduce_nhhg (field_6zur, field_b_lu) AS (SELECT field_ifx6 AS field_6zur, sum(field__lvx) AS field_b_lu FROM map_ioza GROUP BY field_ifx6), map_d08x (field_6zur, field_b_lu) AS (SELECT field_6zur AS field_6zur, pow(field_b_lu, 2) AS field_b_lu FROM reduce_nhhg), map_933q (field__lvx, field_ifx6) AS (SELECT field_b_lu AS field__lvx, field_6zur AS field_ifx6 FROM map_d08x), reduce_ci7j (field_6zur, field_b_lu) AS (SELECT field_ifx6 AS field_6zur, sum(field__lvx) AS field_b_lu FROM map_933q GROUP BY field_ifx6), map_b_ik (field_6zur, field_b_lu) AS (SELECT field_6zur AS field_6zur, (1) / ((greatest(1, (sqrt(field_b_lu)) / ((24))))) AS field_b_lu FROM reduce_ci7j), join_2ou_ (field_b_lu, field_6zur, _SCALE_FACTOR_field_6zur, _SCALE_FACTOR_field_b_lu) AS (SELECT * FROM map_25wv JOIN map_b_ik ON (map_25wv.field_6zur) = (map_b_ik.field_6zur)), map_j3_6 (field_b_lu, field_6zur, _SCALE_FACTOR_field_6zur, _SCALE_FACTOR_field_b_lu) AS (SELECT (field_b_lu) * ((_SCALE_FACTOR_field_b_lu)) AS field_b_lu, field_6zur AS field_6zur, _SCALE_FACTOR_field_6zur AS _SCALE_FACTOR_field_6zur, _SCALE_FACTOR_field_b_lu AS _SCALE_FACTOR_field_b_lu FROM join_2ou_), map_0wqs (field__lvx) AS (SELECT field_b_lu AS field__lvx FROM map_j3_6), reduce_yf4d (field_b_lu) AS (SELECT sum(field__lvx) AS field_b_lu FROM map_0wqs), map_j_kc (_SUM_field_8mze) AS (SELECT (field_b_lu) + ((5070.122001628459) * (((sqrt((-2) * ((ln(random()))))) * ((cos((6.283185307179586) * ((random())))))))) AS _SUM_field_8mze FROM reduce_yf4d), map_fl8h (field_zq_o) AS (SELECT _SUM_field_8mze AS field_zq_o FROM map_j_kc) SELECT * FROM map_fl8h",
  "signature": "hOjnhOMOfQgungG9HZht3HofyYKlD4vahDJ6UDzdYR6j8/pWtyWqTskgYAn6u+OWRjlD14I1/40NMzsLefvwuP6Uu89DZlFVwvIxI6aLG/E5BpFZub51sLuwDf9RGDvxHmTKkasGjd+7ne+rKULs4BebE6IGGJLHAEFWIPl7cLpq+JtspxO4PVfMkGMlFHhyewmjruWuytkF2FUr5txYco0vMwUdcNTUuUiVttjCnSRULDbyL9htsVNv+wnzjMOTmCKcMAw6wyH1K9McSMf0uQwCFHnjpiD3qlVV14lnakEajkRCpyGIDgQ/L/2+T0468YM8XNiG5SdhMjfqdVYEGg"
}

### Verify the dp version of the relation
POST https://qrlew-zsyaspsckq-od.a.run.app/verify HTTP/1.2
content-type: application/json

{
  "value": "WITH Join_sgtn (field_lehu, field_g31_, field_5z2s, field_xsv3, field_vhu6, field_cgi2, field_i0go) AS (SELECT * FROM schema.user_table AS user_table JOIN schema.action_table AS action_table ON (action_table.user_id) = (user_table.id)), _PROTECTED_action_table (_PROTECTED_ENTITY_ID_, _PROTECTED_ENTITY_WEIGHT_, action, user_id, duration) AS (SELECT md5(CAST(field_lehu AS VARCHAR)) AS _PROTECTED_ENTITY_ID_, 1 AS _PROTECTED_ENTITY_WEIGHT_, field_vhu6 AS action, field_cgi2 AS user_id, field_i0go AS duration FROM join_sgtn), map_kzp0 (_PROTECTED_ENTITY_ID_, _PROTECTED_ENTITY_WEIGHT_, field_8mze) AS (SELECT _PROTECTED_ENTITY_ID_ AS _PROTECTED_ENTITY_ID_, _PROTECTED_ENTITY_WEIGHT_ AS _PROTECTED_ENTITY_WEIGHT_, duration AS field_8mze FROM _PROTECTED_action_table WHERE ((duration) > (0)) AND ((duration) < (24))), map_25wv (field_b_lu, field_6zur) AS (SELECT field_8mze AS field_b_lu, _PROTECTED_ENTITY_ID_ AS field_6zur FROM map_kzp0), map_ioza (field__lvx, field_ifx6) AS (SELECT field_b_lu AS field__lvx, field_6zur AS field_ifx6 FROM map_25wv), reduce_nhhg (field_6zur, field_b_lu) AS (SELECT field_ifx6 AS field_6zur, sum(field__lvx) AS field_b_lu FROM map_ioza GROUP BY field_ifx6), map_d08x (field_6zur, field_b_lu) AS (SELECT field_6zur AS field_6zur, pow(field_b_lu, 2) AS field_b_lu FROM reduce_nhhg), map_933q (field__lvx, field_ifx6) AS (SELECT field_b_lu AS field__lvx, field_6zur AS field_ifx6 FROM map_d08x), reduce_ci7j (field_6zur, field_b_lu) AS (SELECT field_ifx6 AS field_6zur, sum(field__lvx) AS field_b_lu FROM map_933q GROUP BY field_ifx6), map_b_ik (field_6zur, field_b_lu) AS (SELECT field_6zur AS field_6zur, (1) / ((greatest(1, (sqrt(field_b_lu)) / ((24))))) AS field_b_lu FROM reduce_ci7j), join_2ou_ (field_b_lu, field_6zur, _SCALE_FACTOR_field_6zur, _SCALE_FACTOR_field_b_lu) AS (SELECT * FROM map_25wv JOIN map_b_ik ON (map_25wv.field_6zur) = (map_b_ik.field_6zur)), map_j3_6 (field_b_lu, field_6zur, _SCALE_FACTOR_field_6zur, _SCALE_FACTOR_field_b_lu) AS (SELECT (field_b_lu) * ((_SCALE_FACTOR_field_b_lu)) AS field_b_lu, field_6zur AS field_6zur, _SCALE_FACTOR_field_6zur AS _SCALE_FACTOR_field_6zur, _SCALE_FACTOR_field_b_lu AS _SCALE_FACTOR_field_b_lu FROM join_2ou_), map_0wqs (field__lvx) AS (SELECT field_b_lu AS field__lvx FROM map_j3_6), reduce_yf4d (field_b_lu) AS (SELECT sum(field__lvx) AS field_b_lu FROM map_0wqs), map_j_kc (_SUM_field_8mze) AS (SELECT (field_b_lu) + ((5070.122001628459) * (((sqrt((-2) * ((ln(random()))))) * ((cos((6.283185307179586) * ((random())))))))) AS _SUM_field_8mze FROM reduce_yf4d), map_fl8h (field_zq_o) AS (SELECT _SUM_field_8mze AS field_zq_o FROM map_j_kc) SELECT * FROM map_fl8h",
  "signature": "hOjnhOMOfQgungG9HZht3HofyYKlD4vahDJ6UDzdYR6j8/pWtyWqTskgYAn6u+OWRjlD14I1/40NMzsLefvwuP6Uu89DZlFVwvIxI6aLG/E5BpFZub51sLuwDf9RGDvxHmTKkasGjd+7ne+rKULs4BebE6IGGJLHAEFWIPl7cLpq+JtspxO4PVfMkGMlFHhyewmjruWuytkF2FUr5txYco0vMwUdcNTUuUiVttjCnSRULDbyL9htsVNv+wnzjMOTmCKcMAw6wyH1K9McSMf0uQwCFHnjpiD3qlVV14lnakEajkRCpyGIDgQ/L/2+T0468YM8XNiG5SdhMjfqdVYEGg"
}